!function(e){var t={};function i(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(n,s,function(t){return e[t]}.bind(null,s));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=4)}([function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.trackEvent=void 0;const n=i(1),s=String(Math.floor((new Date).getTime()/1e3));function o(){const e=document.getElementsByClassName("pinning-header")[0];if(e){const t=e.closest("div[lang]");if(t)return t.getAttribute("lang")||"none"}return document.documentElement.getAttribute("lang")||"none"}let r=[];const l=n.default((function(e){chrome.runtime.sendMessage({type:"TRACK",payload:{data:e,commonData:{session_id:s,event_user_lang:o(),event_useragent:window.navigator.userAgent}}})}),500,()=>{r=[]});t.trackEvent=function(e,t,i){r.push({name:e,category:t,params:i||null}),l(r)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t=200,i){let n;return function(...s){const o=this;clearTimeout(n),n=setTimeout((function(){n=void 0,e.apply(o,s),i()}),t)}}},,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(5),s=i(6),o=i(0);i(8);const r=new s.default;n.default(window,{ArrowDown:function(e){e.preventDefault(),r.focusRow("down"),o.trackEvent("arrow_click","content_script",{event_arrow_key:"down"})},ArrowUp:function(e){e.preventDefault(),r.focusRow("up"),o.trackEvent("arrow_click","content_script",{event_arrow_key:"up"})},ArrowRight:function(e){e.preventDefault(),r.navigateSlider("right"),o.trackEvent("arrow_click","content_script",{event_arrow_key:"right"})},ArrowLeft:function(e){e.preventDefault(),r.navigateSlider("left"),o.trackEvent("arrow_click","content_script",{event_arrow_key:"left"})},S:function(){r.openSearch(),o.trackEvent("search_click","content_script")},Enter:function(){r.isSliderItemInFocus()&&o.trackEvent("detail_modal_click","content_script")}}),window.addEventListener("load",()=>{o.trackEvent("content_page_load","content_script")})},function(e,t,i){"use strict";i.r(t);var n=["Shift","Meta","Alt","Control"],s="object"==typeof navigator&&/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"Meta":"Control";t.default=function(e,t){var i=Object.keys(t).map((function(e){return[(i=e,i.trim().split(" ").map((function(e){var t=e.split("+"),i=t.pop();return[t=t.map((function(e){return"$mod"===e?s:e})),i]}))),t[e]];var i})),o=new Map,r=null,l=function(e){e instanceof KeyboardEvent&&(i.forEach((function(t){var i=t[0],s=t[1],r=o.get(i)||i;!function(e,t){return!(t[1].toUpperCase()!==e.key.toUpperCase()&&t[1]!==e.code||t[0].find((function(t){return!e.getModifierState(t)}))||n.find((function(i){return!t[0].includes(i)&&t[1]!==i&&e.getModifierState(i)})))}(e,r[0])?e.getModifierState(e.key)||o.delete(i):r.length>1?o.set(i,r.slice(1)):(o.delete(i),s(e))})),r&&clearTimeout(r),r=setTimeout(o.clear.bind(o),1e3))};return e.addEventListener("keydown",l),function(){e.removeEventListener("keydown",l)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(7),s=i(0),o=/title-card-([0-9]+)-([0-9]+)/,r=/slider-item-([0-9]+)/;t.default=class{constructor(){this.currentActiveRow=null,this.lastActiveRow=null,this.columnCount=this._getMaxColumnCount(),this.activeColumnIndex=-1,this.rowClassName="lolomoRow",this.activeRowClassName="netflix-navigator-row--active",this.activeSliderItemClassName="netflix-navigator-slider-item--focus",this.isSliderControlButtonClickInProgress=!1,this.miniPreviewModalTimerId=void 0,this.miniPreviewModalAutoplayDelay=1e3,this.miniPreviewModalObserver=new MutationObserver(this._miniPreviewModalMutationObserverHandler.bind(this)),this.isMiniPreviewModalActive=!1}focusRow(e="down"){if(this._isDetailModalOpen())return;this._setUpViewType();const t=document.getElementsByClassName(this.rowClassName);if(0===t.length)return;let i=null;const s=document.getElementsByClassName(this.activeRowClassName)[0];if(s){const t=this._getSiblingRow(s,"down"===e?"next":"previous");i=t||s}else i=this._getInitialRowToFocus(),this.activeColumnIndex=-1;i&&(s&&(s.classList.remove(this.activeRowClassName),n.isInViewport(s)||n.isInViewport(i)||this._isRowInViewportSpecial(s)||(i=this._getInitialRowToFocus(),this.activeColumnIndex=-1)),i.classList.add(this.activeRowClassName),this.lastActiveRow=this.currentActiveRow,this.currentActiveRow=i,this._isBillboardRow(i)?(this._setBillboardFocus(),window.scrollTo(0,i.offsetTop)):(this._focusSliderItemInRow(e),this._getRowIntoViewport(i,i===t[0],e)))}navigateSlider(e="right"){this._isDetailModalOpen()||(this.currentActiveRow&&!n.isInViewport(this.currentActiveRow)?this.focusRow("down"):this._focusSliderItemInRow(e))}isSliderItemInFocus(){if(this.currentActiveRow){const e=this.currentActiveRow.querySelector(`.${this.activeSliderItemClassName} a.slider-refocus`);if(e&&document.activeElement===e)return!0}return!1}openSearch(){if(this._isDetailModalOpen())return;const e=document.querySelector(".main-header .searchTab");if(e&&e instanceof HTMLElement)return void setTimeout(()=>{e.click()},0);const t=document.querySelector(".main-header .searchInput");if(t){const e=t.querySelector("input[name='searchInput']");e&&e!==document.activeElement&&e instanceof HTMLElement&&setTimeout(()=>{e.focus()},0)}else;}_getMaxColumnCount(){this._setUpViewType();if(this._isGridView()){const e=document.getElementsByClassName(this.rowClassName);if(0===e.length)return 6;const t=e[0].querySelectorAll(".slider .slider-item").length;return 0!==t?t:6}{const e=document.getElementsByClassName(this.rowClassName);if(0===e.length)return 6;let t=0;for(let i=0;i<e.length;i++){const n=e[i];if(this._isRowSpecial(n))continue;const s=n.getElementsByClassName("slider")[0];if(!s)continue;const o=s.getElementsByClassName("sliderContent")[0];if(!o)continue;const r=s.getElementsByClassName("slider-item-")[0];if(!r)continue;const l=Array.prototype.indexOf.call(o.children,r),a=s.getElementsByClassName("slider-item");for(let e=0;e<a.length;e++){if(-1!==this._getSliderItemIndex(a[e]))t+=1;else if(0!==t)break}if(t-=0===l?2:1,0!==t)break}return t>0?t:6}}_isGridView(){return Boolean(document.getElementsByClassName("galleryLockups")[0])}_setUpViewType(){this._isGridView()?this.rowClassName="rowContainer":this.rowClassName="lolomoRow"}_getFirstRowFromViewport(){const e=document.getElementsByClassName(this.rowClassName);if(0===e.length)return null;return Array.from(e).find(e=>n.isInViewport(e))||null}_getFirstNRowsFromViewport(e){const t=document.getElementsByClassName(this.rowClassName);let i=[];if(0===t.length)return i;for(let s=0;s<t.length&&(!n.isInViewport(t[s])||(i.push(t[s]),i.length!==e));s++);return i}_isBigRow(e){return e.classList.contains("lolomoBigRow")}_isOriginalsRow(e){return e.classList.contains("originals-panels-row")}_isRowSpecial(e){return this._isBigRow(e)||this._isOriginalsRow(e)}_setBigRowFocus(e){this._resetBillboardFocus(),this._resetLastActiveSliderItem();const t=e.querySelector(".bigRowItem .playLink");t&&t instanceof HTMLElement&&t.focus()}_resetBigRowFocus(e){const t=e.querySelector(".bigRowItem .playLink");t&&t instanceof HTMLElement&&t.blur()}_isRowInViewportSpecial(e){const t=this._isOriginalsRow(e)||!!this.lastActiveRow&&this._isOriginalsRow(this.lastActiveRow);if(t)return t;const i=this._isBigRow(e)||!!this.lastActiveRow&&this._isBigRow(this.lastActiveRow);return i||!1}_getInitialRowToFocus(){let e=null;if(this._isBillboardInViewport())e=document.getElementsByClassName("volatile-billboard-animations-container")[0];else if(e=this._getFirstRowFromViewport(),!e){const t=document.getElementsByClassName(this.rowClassName);0!==t.length&&(e=t[0])}return e}_getSiblingRow(e,t="next"){if("next"===t)return e.nextElementSibling&&e.nextElementSibling.classList.contains(this.rowClassName)?e.nextElementSibling:null;if("previous"===t){const t=e.previousElementSibling;if(t)return t.classList.contains(this.rowClassName)||t.classList.contains("volatile-billboard-animations-container")?t:null}}_getRowIntoViewport(e,t,i){if(t){const t=e.offsetTop-(document.getElementsByClassName("pinning-header-container")[0].offsetHeight+10);window.scrollTo(0,t)}else if(!n.isInViewport(e))if("up"===i){const t=e.offsetTop-("rowContainer"===this.rowClassName?0:document.getElementsByClassName("pinning-header-container")[0].offsetHeight+10);window.scrollTo(0,t)}else{let t=e;if(this._isRowInViewportSpecial(e))t=e;else{const e=this._getFirstNRowsFromViewport(2),i=e[1]||e[0];i&&!this._isRowInViewportSpecial(i)&&(t=i)}const i=t.offsetTop-(document.getElementsByClassName("pinning-header-container")[0].offsetHeight+10)*("rowContainer"===this.rowClassName?-1:1);window.scrollTo(0,i)}}_isBillboardRow(e){return!!e.classList.contains("volatile-billboard-animations-container")}_isBillboardInViewport(){const e=document.getElementsByClassName("volatile-billboard-animations-container")[0];if(e){const t=e.getElementsByClassName("logo-and-text")[0];return!(!t||!n.isInViewport(t))}return!1}_setBillboardFocus(){this._resetLastActiveSliderItem(),this.activeColumnIndex=-1;const e=document.querySelector(".volatile-billboard-animations-container .billboard-links .playLink .color-primary");e&&e instanceof HTMLElement&&e.focus({preventScroll:!0})}_resetBillboardFocus(){const e=document.querySelector(".volatile-billboard-animations-container .billboard-links .playLink .color-primary");e&&e===document.activeElement&&e instanceof HTMLElement&&e.blur()}_focusSliderItemInRow(e){const t=this.currentActiveRow.getElementsByClassName("slider")[0];if(t)if(-1===this.activeColumnIndex)this._hasSliderMovedOnce(t)?this._setCurrentActiveSliderItem(1):this._setCurrentActiveSliderItem(0);else if("right"===e||"left"===e){const i=t.getElementsByClassName(this.activeSliderItemClassName)[0];i&&n.isInViewport(i)?this._getSiblingSliderItemIndex(e).then(e=>{void 0!==e&&this._setCurrentActiveSliderItem(e)}).catch(e=>{console.error(e)}):this._hasSliderMovedOnce(t)?this._setCurrentActiveSliderItem(1):this._setCurrentActiveSliderItem(0)}else{const e=this._hasSliderMovedOnce(this.lastActiveRow),t=this._hasSliderMovedOnce(this.currentActiveRow);e&&!t?this._setCurrentActiveSliderItem(this.activeColumnIndex-1):!e&&t?this._setCurrentActiveSliderItem(this.activeColumnIndex+1):this._setCurrentActiveSliderItem(this.activeColumnIndex)}else this._isBigRow(this.currentActiveRow)&&this._setBigRowFocus(this.currentActiveRow)}_hasSliderMovedOnce(e){if(!e)return!1;const t=e.getElementsByClassName("sliderContent")[0];if(!t)return!1;const i=e.getElementsByClassName("slider-item-")[0];if(!i)return!1;return 0===Array.prototype.indexOf.call(t.children,i)}_setCurrentActiveSliderItem(e){this._resetBillboardFocus(),this._resetLastActiveSliderItem();const t=this.currentActiveRow.getElementsByClassName("slider")[0];if(t){const i=t.getElementsByClassName("slider-item-"+e)[0];if(i)i.classList.add(this.activeSliderItemClassName),this._focusSliderItemCard(i),this.activeColumnIndex=e;else{const e=t.getElementsByClassName("slider-item");if(0!==e.length){const t=e[e.length-1];t.classList.add(this.activeSliderItemClassName),this._focusSliderItemCard(t),this.activeColumnIndex=e.length-1}else this.activeColumnIndex=-1}}}_resetLastActiveSliderItem(){[this.lastActiveRow,this.currentActiveRow].filter(e=>e).forEach(e=>{const t=e.getElementsByClassName("slider")[0];if(t){const e=t.getElementsByClassName(this.activeSliderItemClassName)[0];e&&(e.classList.remove(this.activeSliderItemClassName),this._closeMiniPreviewModal(e))}else this._isBigRow(e)&&this._resetBigRowFocus(e)})}_getSiblingSliderItemIndex(e="right"){return new Promise((t,i)=>{const o=this.currentActiveRow.getElementsByClassName(this.activeSliderItemClassName)[0];if(o)if("left"===e){if(!o.previousElementSibling)return this.activeColumnIndex}else if(!o.nextElementSibling)return this.activeColumnIndex;const r=this._hasSliderMovedOnce(this.currentActiveRow)?"left"===e?1:this.columnCount:"left"===e?0:this.columnCount-1;if(this.activeColumnIndex===r){if(this.isSliderControlButtonClickInProgress)return void t();const i=this.currentActiveRow.getElementsByClassName("left"===e?"handlePrev":"handleNext")[0];if(!i)return void t();const r=this.currentActiveRow.getElementsByClassName("slider")[0],l=r.getElementsByClassName("sliderContent")[0],a=r.getElementsByClassName(this.activeSliderItemClassName)[0],c=this._getSliderItemCardDetails(a),u=this;let d=void 0;l.addEventListener("transitionend",(function i(s){s.target===l&&(clearTimeout(d),d=setTimeout(()=>{let s;const o=r.querySelectorAll(`[id="title-card-${c.rowIndex}-${c.cardIndex+("left"===e?-1:1)}"]`),a=Array.from(o).find(e=>n.isInViewport(e));if(a){const e=a.closest(".slider-item");s=u._getSliderItemIndex(e)}else s="left"===e?u.columnCount:1;l.removeEventListener("transitionend",i),u.isSliderControlButtonClickInProgress=!1,t(s)},300))})),o&&this._closeMiniPreviewModal(o),i instanceof HTMLElement&&i.click(),this.isSliderControlButtonClickInProgress=!0,s.trackEvent("slider_controls_click","content_script",{event_slider_key:e})}else t(this.activeColumnIndex+("left"===e?-1:1))})}_focusSliderItemCard(e){const t=e.getElementsByClassName("title-card")[0];if(!t)return;const i=t.querySelector("a.slider-refocus");i&&i instanceof HTMLElement&&i.focus({preventScroll:!0}),this._openMiniPreviewModal(e)}_getCardIdDetails(e){const t=e.match(o);return{row:Number(t[1]),index:Number(t[2])}}_getSliderItemIndex(e){const t=e.classList;let i=-1;const n=Array.from(t).find(e=>r.test(e));return n&&(i=Number(n.match(r)[1])),i}_getSliderItemCardDetails(e){let t=-1,i=-1;const n=e.getElementsByClassName("title-card")[0];if(n){const e=n.getAttribute("id");if(e){const n=this._getCardIdDetails(e);t=n.row,i=n.index}}return{rowIndex:t,cardIndex:i}}_openMiniPreviewModal(e){const t=e.getElementsByClassName("title-card")[0];t&&(clearTimeout(this.miniPreviewModalTimerId),this.miniPreviewModalTimerId=setTimeout(()=>{if(this._isDetailModalOpen())return void setTimeout(()=>{this._focusDetailModalPlayButton()},500);if(this.isSliderControlButtonClickInProgress)return;const e=new MouseEvent("mouseover",{bubbles:!0,cancelable:!0,composed:!0});this.isMiniPreviewModalActive=!0,this.miniPreviewModalObserver.observe(document.documentElement,{childList:!0,subtree:!0}),t.dispatchEvent(e),s.trackEvent("mini_modal_view","content_script")},this.miniPreviewModalAutoplayDelay))}_closeMiniPreviewModal(e){if(e instanceof HTMLElement&&e.blur(),clearTimeout(this.miniPreviewModalTimerId),this.isMiniPreviewModalActive){const t=e.getElementsByClassName("title-card")[0],i=new MouseEvent("mouseout",{bubbles:!0,cancelable:!0,composed:!0}),n=new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,composed:!0,key:"Escape"});t&&t.dispatchEvent(i),window.dispatchEvent(n),this.isMiniPreviewModalActive=!1}}_handleSpecialMiniPreviewModalClose(){const e=this;document.addEventListener("mousemove",(function t(i){const n=document.querySelector(`.${e.activeSliderItemClassName} .bob-card-adult-tall-panel-video-merch`);n&&!n.contains(i.target)&&(setTimeout(()=>{const e=n.closest(".bob-container");if(!e)return;const t=new MouseEvent("mouseout",{bubbles:!0,cancelable:!0,composed:!0});e.dispatchEvent(t)},100),document.removeEventListener("mousemove",t))}))}_miniPreviewModalMutationObserverHandler(e){e.forEach(e=>{if("childList"===e.type){const t=e.addedNodes;for(let e=0;e<t.length;e++){const i=t[e];if(i&&i.classList){let e=!1;if(i.classList.contains("previewModal--wrapper")&&i.classList.contains("mini-modal")){e=!0;const t=i.querySelector(".buttonControls--container .playLink");t&&setTimeout(()=>{t instanceof HTMLElement&&t.focus({preventScroll:!0})},250)}else if(i.classList.contains("bob-card-adult-tall-panel-video-merch")){e=!0;const t=i.querySelector(".bob-buttons-wrapper .playLink");t&&setTimeout(()=>{t instanceof HTMLElement&&t.focus({preventScroll:!0}),this._handleSpecialMiniPreviewModalClose()},250)}if(e){this.miniPreviewModalObserver.disconnect();break}}}}})}_isDetailModalOpen(){return!!document.getElementsByClassName("previewModal--wrapper detail-modal")[0]}_focusDetailModalPlayButton(){const e=document.querySelector(".previewModal--wrapper.detail-modal .buttonControls--container .playLink");e&&e instanceof HTMLElement&&e.focus({preventScroll:!0})}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isInViewport=void 0,t.isInViewport=function(e){const t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&Math.floor(t.bottom)<=(window.innerHeight||document.documentElement.clientHeight)&&Math.floor(t.right)<=(window.innerWidth||document.documentElement.clientWidth)}},function(e,t,i){}]);